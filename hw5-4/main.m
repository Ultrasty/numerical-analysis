f = @(x) (x.^4).*(1-x).^4./(1+x.^2);
a = 0;
b = 1;
m = 2;
t(1) = 0.5*(b-a)*(f(a)+f(b));
t(2) = 0.5*t(1) + 0.5*(b-a)*f((a+b)/2);
s(1) = ( 4*t(2)-t(1) ) / 3 ;
j = 2;
while abs(t(j)-t(j-1)) > (1e-7)
    h = (b-a)/m;
    k = 0:(m-1);
    j = j + 1;
    t(j)= 0.5*t(j-1) + 0.5 * h * sum(f(a+(k+1/2)*h));
    s(j-1) = ( 4*t(j)-t(j-1) ) / 3 ;
    c(j-2) = (16*s(j-1)-s(j-2) ) / 15 ;
    if j>3
        r(j-3) = (64*c(j-2)-c(j-3) ) / 63 ;
    end
    m = m * 2;
end
result = r(end);